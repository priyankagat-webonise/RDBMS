create or replace view monthly_report as select o.order_id as 'order id',o.date as 'order date',GROUP_CONCAT(DISTINCT(p.product_name)) as 'product names',GROUP_CONCAT(DISTINCT(i.price)) as 'product price',sum(i.price) as 'total cost',u.name as 'user name',u.email as 'email' from orders o INNER JOIN ordered od ON o.order_id=od.order_id INNER JOIN items i ON od.product_id=i.product_id INNER JOIN products p ON i.product_id=p.product_id INNER JOIN ordered od1 ON p.product_id=od1.product_id INNER JOIN customer c ON od1.order_id=c.order_id INNER JOIN users u ON c.user_id=u.user_id where o.date between NOW() - INTERVAL 30 DAY and NOW() and u.user_type='buyer'  group by o.order_id;
